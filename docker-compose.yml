version: "3.9"

services:
    genpac:
        build:
            context: .
            dockerfile: Dockerfile
        container_name: genpac-runner
        restart: unless-stopped

        environment:
            CRON_SCHEDULE: "0 0 */3 * *"

            # æ—¶åŒº
            TZ: Asia/Shanghai

            # PAC é…ç½®
            PAC_PROXY: "SOCKS5 192.168.31.200:7893; DIRECT"
            PAC_COMPRESS: "true"
            PAC_PRECISE: "false"
            GFWLIST_URL: "https://github.mus.pp.ua/https://github.com/gfwlist/gfwlist/raw/master/gfwlist.txt"

            # è‡ªå®šä¹‰åˆ—è¡¨
            PAC_DIRECT_LIST: ""
            PAC_PROXY_LIST: ""
            PAC_BLOCK_LIST: ""

            # webhook å¯é€‰ï¼Œä¸è®¾ç½®åˆ™ä¸è§¦å‘
            WEBHOOK_SUCCESS_URL: "https://oapi.dingtalk.com/robot/send?access_token=Token"
            WEBHOOK_SUCCESS_OPTIONS: |
                {
                  "msgtype": "markdown",
                  "markdown": {
                    "title": "tracker",
                    "text": "âœ… genpac æ›´æ–°æˆåŠŸ \n ğŸ“¦ proxy.pac å·²ç”Ÿæˆ"
                  }
                }

            WEBHOOK_FAILURE_URL: "https://oapi.dingtalk.com/robot/send?access_token=Token"
            WEBHOOK_FAILURE_OPTIONS: |
                {
                  "msgtype": "markdown",
                  "markdown": {
                    "title": "tracker",
                    "text": "âŒ genpac æ›´æ–°å¤±è´¥"
                  }
                }

        # æš´éœ² HTTP ç«¯å£
        ports:
            - "8080:8080"

        # volumes å¯ä»¥å»æ‰ï¼Œå¦‚æœä¸éœ€è¦æŒä¹…åŒ–
        # volumes:
        #   - /data/genpac-data:/data
